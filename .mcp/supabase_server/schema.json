{
  "name": "supabase",
  "description": "Supabase MCP Server for AwaOS - Database, Storage, and Vector Memory",
  "version": "1.0.0",
  "schema_version": "1.0",
  "tables": {
    "realm_registry": {
      "description": "Registry of all AwaOS realms",
      "columns": {
        "realm_id": "uuid PRIMARY KEY",
        "name": "text NOT NULL",
        "glyph": "text DEFAULT 'koru_blue'",
        "kaitiaki": "text",
        "created_at": "timestamp DEFAULT now()",
        "status": "text DEFAULT 'active'"
      }
    },
    "ti_memory": {
      "description": "Vector memory storage with embeddings",
      "columns": {
        "id": "uuid PRIMARY KEY DEFAULT gen_random_uuid()",
        "realm_id": "text NOT NULL",
        "content": "text NOT NULL",
        "embedding": "vector(1536)",
        "metadata": "jsonb",
        "tapu": "integer DEFAULT 0",
        "created_at": "timestamp DEFAULT now()"
      }
    },
    "pdf_summaries": {
      "description": "PDF document summaries and extractions",
      "columns": {
        "id": "uuid PRIMARY KEY DEFAULT gen_random_uuid()",
        "realm_id": "text",
        "source_file": "text",
        "summary": "text",
        "keywords": "text[]",
        "whakataukÄ«": "text",
        "embedding": "vector(1536)",
        "created_at": "timestamp DEFAULT now()"
      }
    },
    "ocr_logs": {
      "description": "OCR processing logs",
      "columns": {
        "id": "uuid PRIMARY KEY DEFAULT gen_random_uuid()",
        "realm_id": "text",
        "source_type": "text",
        "source_path": "text",
        "extracted_text": "text",
        "confidence": "float",
        "language_detected": "text",
        "created_at": "timestamp DEFAULT now()"
      }
    },
    "translations": {
      "description": "Translation records",
      "columns": {
        "id": "uuid PRIMARY KEY DEFAULT gen_random_uuid()",
        "source_lang": "text",
        "target_lang": "text",
        "source_text": "text NOT NULL",
        "translated_text": "text NOT NULL",
        "dialect": "text DEFAULT 'standard'",
        "realm_id": "text",
        "created_at": "timestamp DEFAULT now()"
      }
    },
    "translation_glossary": {
      "description": "Term definitions for translation",
      "columns": {
        "id": "uuid PRIMARY KEY DEFAULT gen_random_uuid()",
        "term_maori": "text NOT NULL",
        "term_english": "text NOT NULL",
        "context": "text",
        "dialect": "text DEFAULT 'standard'",
        "approved": "boolean DEFAULT false"
      }
    },
    "taonga": {
      "description": "Cultural treasures and artifacts",
      "columns": {
        "id": "uuid PRIMARY KEY DEFAULT gen_random_uuid()",
        "name": "text NOT NULL",
        "description": "text",
        "tapu_level": "integer DEFAULT 0",
        "mana_required": "text[]",
        "realm_id": "text",
        "storage_path": "text",
        "metadata": "jsonb",
        "created_at": "timestamp DEFAULT now()"
      }
    },
    "kaitiaki_registry": {
      "description": "Registry of all kaitiaki agents",
      "columns": {
        "id": "uuid PRIMARY KEY DEFAULT gen_random_uuid()",
        "name": "text NOT NULL",
        "realm_id": "text",
        "role": "text",
        "glyph": "text",
        "vector_store_id": "text",
        "lineage": "text",
        "stage": "text DEFAULT 'seed'",
        "invocation_count": "integer DEFAULT 0",
        "created_at": "timestamp DEFAULT now()"
      }
    },
    "security_audit_log": {
      "description": "Security and access audit logs",
      "columns": {
        "id": "uuid PRIMARY KEY DEFAULT gen_random_uuid()",
        "event_type": "text NOT NULL",
        "realm_id": "text",
        "actor": "text",
        "resource": "text",
        "action": "text",
        "result": "text",
        "metadata": "jsonb",
        "timestamp": "timestamp DEFAULT now()"
      }
    }
  },
  "buckets": [
    {
      "name": "taonga-uploads",
      "public": false,
      "description": "Secure storage for taonga files"
    },
    {
      "name": "pdf-documents",
      "public": false,
      "description": "PDF document storage"
    },
    {
      "name": "ocr-images",
      "public": false,
      "description": "Images for OCR processing"
    },
    {
      "name": "realm-assets",
      "public": true,
      "description": "Public realm assets (glyphs, icons)"
    }
  ],
  "rpc_functions": {
    "match_memories": {
      "description": "Vector similarity search with tapu filtering",
      "params": ["query_embedding", "match_realm", "match_threshold", "match_count", "include_tapu"]
    },
    "get_translation_with_memory": {
      "description": "Get translation using translation memory",
      "params": ["source_text", "source_lang", "target_lang", "dialect"]
    }
  }
}
