# Realm Generator - Creating New Specialized Realms

The **Realm Generator** allows you to quickly spin up new specialized realms (Cards Realm, Translator Realm, etc.) with their own Kaitiaki agents that talk back to the main Te Pō backend.

## Quick Start

```bash
python te_hau/scripts/generate_realm.py \
  --name "Cards Realm" \
  --slug cards_realm \
  --kaitiaki-name "katu" \
  --kaitiaki-role "cards_oracle" \
  --description "Oracle for card cataloging and search" \
  --push-to-git https://github.com/org/cards-realm.git
```

## What Gets Generated

For a realm called `cards_realm` with Kaitiaki named `katu`:

```
cards_realm/
├── .env                          ← Customized environment
├── config/                       ← Realm configs
├── mini_te_po/                   ← Local backend
├── te_ao/                        ← Local frontend (from template)
├── kaitiaki/
│   └── katu/
│       ├── katu_manifest.json    ← Runtime manifest (generated)
│       └── docs/
│           ├── README.md         ← Kaitiaki docs
│           └── CONTEXT.md        ← Development context
├── mauri/
│   ├── kaitiaki_templates/
│   │   └── katu.yaml             ← Source definition (editable)
│   └── state/                    ← Realm state
└── scripts/
    └── new_realm.sh              ← Deployment helpers
```

## Arguments

| Argument | Required | Description |
|----------|----------|-------------|
| `--name` | ✅ | Display name (e.g., "Cards Realm") |
| `--slug` | ✅ | URL-safe slug (e.g., "cards_realm") |
| `--kaitiaki-name` | ✅ | Kaitiaki agent name (e.g., "katu") |
| `--kaitiaki-role` | ✅ | Agent role/type (e.g., "cards_oracle") |
| `--description` | ✅ | What the Kaitiaki does |
| `--push-to-git` | ❌ | Optional git URL to push to |

## How It Works

### 1. **Clone Template**
Copies `te_hau/project_template/` to the new realm directory

### 2. **Customize Configs**
- Replaces `TemplateRealm` with your realm name
- Updates `.env` files
- Configures local frontend/backend

### 3. **Generate Kaitiaki**
- Creates `mauri/kaitiaki_templates/{kaitiaki_name}.yaml`
- Creates initial `{kaitiaki_name}_manifest.json`
- Sets up state files

### 4. **Create Documentation**
- `README.md` — Overview and basic setup
- `CONTEXT.md` — Development context for the Kaitiaki

### 5. **Optional: Push to Git**
- Initializes git repo
- Creates initial commit
- Pushes to specified git URL

## Workflow After Generation

### Edit the Kaitiaki

Update `mauri/kaitiaki_templates/katu.yaml`:

```yaml
metadata:
  name: katu
  role: cards_oracle
  purpose: Oracle for card cataloging...

# Add custom tools, capabilities, etc.
assistants:
  search:
    description: "Search cards database"
    allowed_tools: [...]
```

### Compile the Kaitiaki

If you have the SDK installed in the realm:

```bash
python mauri/scripts/compile_kaitiaki.py --agent katu
```

Or use the main SDK:

```bash
# From The_Awa_Network directory
python te_hau/scripts/compile_kaitiaki.py \
  --project-dir ../cards_realm \
  --agent katu
```

### Test the Realm

```bash
# Start local backend
cd cards_realm/mini_te_po
python app.py

# In another terminal, start frontend
cd cards_realm
npm run dev
```

## Integration with Main Backend

Each realm's Kaitiaki connects to the main Te Pō backend:

**In `cards_realm/.env`:**
```
TE_PO_BASE_URL=https://main-te-po-backend.example.com
REALM_NAME=cards
```

**Kaitiaki uses this to:**
- Search main vector store
- Log to main Supabase
- Call main Te Pō pipelines
- Stay in sync with main system

## Examples

### Cards Realm
```bash
python te_hau/scripts/generate_realm.py \
  --name "Cards Realm" \
  --slug cards_realm \
  --kaitiaki-name "katu" \
  --kaitiaki-role "cards_oracle" \
  --description "Oracle for card cataloging, search, and context"
```

### Translator Realm
```bash
python te_hau/scripts/generate_realm.py \
  --name "Translator Realm" \
  --slug translator_realm \
  --kaitiaki-name "whare-whakamaori" \
  --kaitiaki-role "translator_oracle" \
  --description "Translator for English ↔ Māori content"
```

### UTF-8 Mi-NZ Realm
```bash
python te_hau/scripts/generate_realm.py \
  --name "UTF-8 Mi-NZ Realm" \
  --slug utf8_realm \
  --kaitiaki-name "taku-kupu" \
  --kaitiaki-role "encoding_oracle" \
  --description "UTF-8 and Māori text encoding specialist"
```

## File Structure Explanation

### `mauri/kaitiaki_templates/{kaitiaki_name}.yaml`
- **What:** Source definition for Kaitiaki
- **Who edits:** You (developer)
- **Purpose:** Version-controlled source of truth
- **Used by:** SDK compiler

### `kaitiaki/{kaitiaki_name}/{kaitiaki_name}_manifest.json`
- **What:** Compiled runtime manifest
- **Who edits:** Generated by SDK (don't edit)
- **Purpose:** What the Kaitiaki actually runs from
- **Used by:** Te Hau CLI, mini_te_po

### `kaitiaki/{kaitiaki_name}/docs/`
- **What:** Context and documentation
- **Who edits:** You or auto-generated
- **Purpose:** Help developers understand the realm
- **Used by:** IDEs for context

## Next Steps

1. **Generate a realm** using this script
2. **Customize Kaitiaki YAML** for your domain
3. **Test locally** with mini_te_po + frontend
4. **Register with main Te Pō** (share JWT keys, etc.)
5. **Deploy** using Cloudflare/Render setup

See `cards_realm/kaitiaki/katu/docs/README.md` for example.
