{
  "tools": [
    {
      "name": "kitenga_whisper",
      "description": "Chat/processing endpoint: supports retrieval, pipeline ingest, vector save, OpenAI summary/translation.",
      "method": "POST",
      "path": "/kitenga/gpt-whisper",
      "ui": {
        "label": "Kitenga Whisper",
        "icon": "chat"
      },
      "auth": null,
      "input_schema": {
        "type": "object",
        "properties": {
          "whisper": {
            "type": "string",
            "description": "User message or text to process"
          },
          "session_id": {
            "type": "string",
            "description": "Chat session id (reuse for context)"
          },
          "thread_id": {
            "type": "string",
            "description": "Assistant thread id (reuse for continuity)"
          },
          "system_prompt": {
            "type": "string",
            "description": "Optional system prompt"
          },
          "run_pipeline": {
            "type": "boolean",
            "default": false
          },
          "save_vector": {
            "type": "boolean",
            "default": true
          },
          "use_retrieval": {
            "type": "boolean",
            "default": true
          },
          "use_openai_summary": {
            "type": "boolean",
            "default": false
          },
          "use_openai_translation": {
            "type": "boolean",
            "default": false
          },
          "source": {
            "type": "string",
            "default": "kitenga_whisper"
          }
        },
        "required": [
          "whisper"
        ]
      }
    },
    {
      "name": "ocr_tool",
      "description": "OCR a remote image/PDF/text file with optional taonga protection.",
      "method": "POST",
      "path": "/kitenga/tool/ocr",
      "ui": {
        "label": "OCR Tool",
        "icon": "scan"
      },
      "auth": null,
      "input_schema": {
        "type": "object",
        "properties": {
          "file_url": {
            "type": "string",
            "description": "URL of the file to OCR"
          },
          "taonga_mode": {
            "type": "boolean",
            "description": "Preserve stealth metadata and taonga protections",
            "default": false
          },
          "prefer_offline": {
            "type": "boolean",
            "description": "Prioritize local OCR before OpenAI vision",
            "default": true
          }
        },
        "required": [
          "file_url"
        ]
      }
    },
    {
      "name": "translate_tool",
      "description": "Translate text into a specified language with cultural context.",
      "method": "POST",
      "path": "/kitenga/tool/translate",
      "ui": {
        "label": "Translate Tool",
        "icon": "language"
      },
      "auth": null,
      "input_schema": {
        "type": "object",
        "properties": {
          "text": {
            "type": "string",
            "description": "Text to translate"
          },
          "target_language": {
            "type": "string",
            "description": "Target language code",
            "default": "mi"
          },
          "context": {
            "type": "string",
            "description": "Optional context or instructions"
          }
        },
        "required": [
          "text"
        ]
      }
    },
    {
      "name": "chat_save_session",
      "description": "Finalize/save a chat session: optional summary, title, tags. Stores audit/logs and returns a summary.",
      "method": "POST",
      "path": "/chat/save-session",
      "ui": {
        "label": "Save Chat Session",
        "icon": "save"
      },
      "auth": null,
      "input_schema": {
        "type": "object",
        "properties": {
          "session_id": {
            "type": "string",
            "description": "Chat session id to finalize"
          },
          "title": {
            "type": "string",
            "description": "Optional title"
          },
          "tags": {
            "type": "string",
            "description": "Optional comma-separated tags"
          },
          "summarize": {
            "type": "boolean",
            "default": true
          }
        },
        "required": [
          "session_id"
        ]
      }
    },
    {
      "name": "pipeline_run",
      "description": "Run the Te P≈ç pipeline on text (or a fetched file URL) for cleaning, chunking, embedding, and vector-store push.",
      "method": "POST",
      "path": "/pipeline/run",
      "ui": {
        "label": "Run Pipeline",
        "icon": "pipeline"
      },
      "auth": {
        "type": "bearer",
        "header": "Authorization",
        "token_env": "PIPELINE_TOKEN"
      },
      "input_schema": {
        "type": "object",
        "properties": {
          "text": {
            "type": "string",
            "description": "Inline text to process"
          },
          "file_url": {
            "type": "string",
            "description": "Optional URL to fetch bytes instead of inline text"
          },
          "source": {
            "type": "string",
            "description": "Label for the pipeline source",
            "default": "assistant_tool"
          }
        },
        "required": []
      }
    },
    {
      "name": "kitenga_vision_ocr",
      "description": "OCR an image via OpenAI vision; optionally save embedding and push through the pipeline.",
      "method": "POST",
      "path": "/kitenga/vision-ocr",
      "ui": {
        "label": "Vision OCR",
        "icon": "camera"
      },
      "auth": {
        "type": "bearer",
        "header": "Authorization",
        "token_env": "PIPELINE_TOKEN"
      },
      "input_schema": {
        "type": "object",
        "properties": {
          "image_base64": {
            "type": "string",
            "description": "Base64-encoded image"
          },
          "save_vector": {
            "type": "boolean",
            "description": "Persist embedding to vector store",
            "default": true
          },
          "run_pipeline": {
            "type": "boolean",
            "description": "Send extracted text through pipeline",
            "default": false
          },
          "pipeline_source": {
            "type": "string",
            "description": "Source tag when pipeline is run",
            "default": "kitenga_vision"
          }
        },
        "required": [
          "image_base64"
        ]
      }
    },
    {
      "name": "assistant_run",
      "description": "Bridge to existing assistant pipeline (text or file_url).",
      "method": "POST",
      "path": "/assistant/run",
      "ui": {
        "label": "Assistant Bridge",
        "icon": "message"
      },
      "auth": {
        "type": "bearer",
        "header": "Authorization",
        "token_env": "PIPELINE_TOKEN"
      },
      "input_schema": {
        "type": "object",
        "properties": {
          "text": {
            "type": "string"
          },
          "file_url": {
            "type": "string"
          },
          "source": {
            "type": "string",
            "default": "assistant"
          }
        },
        "required": []
      }
    },
    {
      "type": "function",
      "function": {
        "name": "enhanced_web_search",
        "description": "Search the web with optional iwi-specific filters; fallback to own vector search if needed.",
        "parameters": {
          "type": "object",
          "properties": {
            "query": {
              "type": "string",
              "description": "Search phrase or question to research"
            },
            "filters": {
              "type": "object",
              "properties": {
                "site": {
                  "type": "array",
                  "items": {
                    "type": "string"
                  },
                  "description": "List of websites to boost (e.g. iwi.govt.nz)"
                }
              }
            },
            "fallback": {
              "type": "boolean",
              "description": "Whether to fallback to own vector/Supabase data if Brave fails",
              "default": true
            }
          },
          "required": [
            "query"
          ]
        }
      }
    },
    {
      "type": "function",
      "function": {
        "name": "run_ocr",
        "description": "Scan an image or PDF (via backend) and return visible + protected metadata.",
        "parameters": {
          "type": "object",
          "properties": {
            "file_url": {
              "type": "string",
              "description": "Supabase/Cloudflare URL of the file to OCR"
            },
            "taonga_mode": {
              "type": "boolean",
              "description": "Apply cultural protection/encoding",
              "default": false
            }
          },
          "required": [
            "file_url"
          ]
        }
      }
    },
    {
      "type": "function",
      "function": {
        "name": "summarise_text",
        "description": "Summarise provided text (or OCR output) via backend summariser.",
        "parameters": {
          "type": "object",
          "properties": {
            "text": {
              "type": "string",
              "description": "The raw text to summarise"
            },
            "mode": {
              "type": "string",
              "description": "Tone/mode e.g. research/taonga",
              "default": "research"
            }
          },
          "required": [
            "text"
          ]
        }
      }
    },
    {
      "type": "function",
      "function": {
        "name": "vector_save",
        "description": "Persist content to Supabase/OpenAI vector store with tags.",
        "parameters": {
          "type": "object",
          "properties": {
            "content": {
              "type": "string",
              "description": "Content to embed/store"
            },
            "tags": {
              "type": "array",
              "items": {
                "type": "string"
              },
              "description": "Tags/labels for this content"
            }
          },
          "required": [
            "content"
          ]
        }
      }
    },
    {
      "type": "function",
      "function": {
        "name": "generate_trade_me_listing",
        "description": "Build Trade Me listing fields from scanned card info.",
        "parameters": {
          "type": "object",
          "properties": {
            "card_name": {
              "type": "string",
              "description": "Card name/title"
            },
            "series": {
              "type": "string",
              "description": "Set/series name"
            },
            "condition": {
              "type": "string",
              "description": "Condition (e.g. NM, LP)"
            }
          },
          "required": [
            "card_name"
          ]
        }
      }
    },
    {
      "name": "vector_batch_status",
      "description": "Check status of a vector store file batch push.",
      "method": "GET",
      "path": "/vector/batch-status",
      "ui": {
        "label": "Vector Batch Status",
        "icon": "activity"
      },
      "auth": null,
      "input_schema": {
        "type": "object",
        "properties": {
          "batch_id": {
            "type": "string"
          },
          "vector_store_id": {
            "type": "string",
            "description": "Optional override; defaults to env"
          }
        },
        "required": [
          "batch_id"
        ]
      }
    },
    {
      "name": "gpt_reason",
      "description": "Summarize the Awa-Kitenga pipeline diagnostic loop",
      "method": "POST",
      "path": "/gpt/bridge",
      "ui": {
        "label": "GPT Reason",
        "icon": "brain"
      },
      "auth": null,
      "input_schema": {
        "type": "object",
        "properties": {
          "query": {
            "type": "string",
            "description": "Diagnostic query"
          }
        },
        "required": [
          "query"
        ]
      },
      "output_schema": {
        "type": "object",
        "properties": {
          "status": {
            "type": "string"
          },
          "reasoning": {
            "type": "string"
          },
          "loop_closed": {
            "type": "boolean"
          },
          "timestamp": {
            "type": "string"
          }
        },
        "required": [
          "status",
          "reasoning",
          "loop_closed",
          "timestamp"
        ]
      }
    },
    {
      "name": "awa_orchestrate",
      "description": "Orchestrate Awa protocol event",
      "method": "POST",
      "path": "/awa/orchestrate",
      "ui": {
        "label": "Awa Orchestrate",
        "icon": "shuffle"
      },
      "auth": null,
      "input_schema": {
        "type": "object",
        "properties": {
          "intent": {
            "type": "string"
          },
          "context": {
            "type": "string"
          },
          "input": {
            "type": "object"
          }
        },
        "required": [
          "intent",
          "context",
          "input"
        ]
      },
      "output_schema": {
        "type": "object",
        "properties": {
          "status": {
            "type": "string"
          },
          "event": {
            "type": "string"
          },
          "timestamp": {
            "type": "string"
          }
        },
        "required": [
          "status",
          "event",
          "timestamp"
        ]
      }
    }
  ],
  "base_url_env": "TE_PO_BASE_URL"
}